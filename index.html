<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>×¡×“×¨ ×–×›×•×™×•×ª | ×‘×“×™×§×” ×§×¦×¨×” ××—×¨×™ ×¤×’×™×¢×” ×‘×¢×‘×•×“×”</title>
  <meta name="description" content="×‘×“×™×§×” ×§×¦×¨×” ×•×œ× ××—×™×™×‘×ª ×©××¡×“×¨×ª ×ª××•× ×” ×¨××©×•× ×™×ª ××—×¨×™ ×¤×’×™×¢×” ×©×§×©×•×¨×” ×œ×¢×‘×•×“×”. ×“×™×¡×§×¨×˜×™. ×‘×¢×¨×š 2 ×“×§×•×ª." />
  <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#0b1220;
      --paper:#f6f8ff;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --line:rgba(148,163,184,.35);
      --primary:#2563eb;
      --primary2:#0ea5e9;
      --shadow: 0 18px 55px rgba(2,6,23,.22);
      --shadow2: 0 12px 30px rgba(2,6,23,.12);
      --r:22px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:'Assistant', system-ui, -apple-system, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 650px at 80% -10%, rgba(14,165,233,.26), transparent 55%),
        radial-gradient(900px 620px at 10% 0%, rgba(34,197,94,.14), transparent 55%),
        radial-gradient(900px 620px at 50% 115%, rgba(249,115,22,.10), transparent 55%),
        linear-gradient(180deg, var(--bg1) 0%, var(--bg1) 34%, var(--paper) 34%, var(--paper) 100%);
      line-height:1.65;
    }

    .wrap{ max-width:1100px; margin:0 auto; padding:20px 16px 90px; }

    .topbar{
      color:#fff; display:flex; align-items:center; justify-content:space-between;
      gap:12px; flex-wrap:wrap; margin-bottom:14px;
    }
    .brand{ display:flex; align-items:center; gap:10px; }
    .mark{
      width:42px; height:42px; border-radius:16px;
      background: linear-gradient(135deg, rgba(255,255,255,.95), rgba(255,255,255,.65));
      display:grid; place-items:center; color:#0b1220; font-weight:900;
      box-shadow: 0 20px 40px rgba(0,0,0,.18);
    }
    .brandTitle{ font-weight:900; letter-spacing:-.2px; }
    .chips{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px;
      background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.18);
      color:rgba(255,255,255,.92);
      font-size:12.5px; font-weight:800;
      backdrop-filter: blur(10px);
      white-space:nowrap;
    }
    .dot{ width:8px; height:8px; border-radius:99px; background:#86efac; }

    .shell{
      margin-top:8px;
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(255,255,255,.55);
      border-radius: 28px;
      padding: 16px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }

    .grid{ display:grid; grid-template-columns: 1.3fr .7fr; gap:14px; }
    @media (max-width: 980px){ .grid{ grid-template-columns:1fr; } }

    .card{
      background:var(--card);
      border:1px solid rgba(148,163,184,.28);
      border-radius: 24px;
      padding: 22px;
      box-shadow: var(--shadow2);
      min-width:0;
    }

    h1{
      margin:0 0 10px;
      font-size: 38px;
      line-height:1.1;
      letter-spacing:-.6px;
      font-weight:900;
    }
    .lead{
      margin:0 0 16px;
      color:var(--muted);
      font-size: 17px;
      max-width: 62ch;
    }

    .ctaRow{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top: 8px; }
    .btn{
      border:0; cursor:pointer;
      border-radius: 18px;
      padding: 14px 18px;
      font-weight:900;
      font-size: 16.5px;
      color:#fff;
      background: linear-gradient(135deg, var(--primary), var(--primary2));
      box-shadow: 0 18px 30px rgba(37,99,235,.22);
      transition: transform .15s ease, filter .15s ease;
      font-family: inherit;
    }
    .btn:hover{ transform: translateY(-1px); filter: brightness(1.03); }
    .btn:disabled{ opacity:.65; cursor:not-allowed; transform:none; }
    .btnGhost{ background:#fff; color:var(--text); border:1px solid rgba(148,163,184,.35); box-shadow:none; }

    .features{
      display:grid;
      grid-template-columns: repeat(3, minmax(220px, 1fr));
      gap: 14px;
      margin-top: 18px;
      align-items: stretch;
    }
    @media (max-width: 980px){ .features{ grid-template-columns: repeat(2, minmax(200px, 1fr)); } }
    @media (max-width: 560px){ .features{ grid-template-columns: 1fr; } }

    .feat{
      border-radius: 20px;
      padding: 16px;
      border:1px solid rgba(148,163,184,.25);
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      display:grid;
      grid-template-columns: 44px 1fr;
      gap: 12px;
      min-height: 118px;
      align-content: center;
    }
    .ico{
      width: 44px; height: 44px;
      border-radius: 16px;
      background: rgba(37,99,235,.09);
      display:grid; place-items:center;
      color: #1d4ed8;
      font-weight: 900;
      font-size: 20px;
    }
    .feat b{ display:block; margin:0 0 6px; font-size: 16px; line-height:1.2; font-weight:900; }
    .feat span{ display:block; font-size: 13.5px; line-height: 1.45; color: var(--muted); max-width: 40ch; }

    details{
      border:1px solid rgba(148,163,184,.28);
      border-radius: 18px;
      background:#fff;
      padding: 12px 14px;
      margin: 10px 0;
    }
    summary{ cursor:pointer; font-weight:900; list-style:none; }
    details p{ color:var(--muted); margin:10px 0 0; }

    .hidden{ display:none !important; }

    /* âœ… "××™×š ×–×” ×¢×•×‘×“" - ×ª×™×§×•×Ÿ ×”×‘×¢×™×” ×©×œ ×¨×™×‘×•×¢×™× ×¦×¨×™× */
    .howWrap{
      display:grid;
      gap:10px;
      align-items:stretch;
    }
    .howItem{
      width:100%;
      align-self:stretch;
      border:1px solid rgba(148,163,184,.25);
      border-radius:18px;
      padding:14px;
      background:#fff;
      display:flex;
      gap:12px;
      min-width:0;
    }
    .howNum{
      width:30px;height:30px;border-radius:12px;
      display:grid;place-items:center;
      background:rgba(14,165,233,.10);
      color:#0369a1;
      font-weight:900;
      flex:0 0 auto;
    }

    /* QUIZ */
    .quizHead{ display:flex; justify-content:space-between; gap:12px; align-items:center; flex-wrap:wrap; }
    .progressText{ font-size: 13px; color:var(--muted); font-weight:800; }
    .bar{ height: 10px; background: rgba(148,163,184,.25); border-radius: 999px; overflow:hidden; margin: 10px 0 16px; }
    .fill{ height:100%; width:0%; background: linear-gradient(90deg, var(--primary), var(--primary2), #22c55e); transition: width .25s ease; }
    .qTitle{ margin: 0 0 8px; font-size: 22px; font-weight: 900; letter-spacing:-.2px; }
    .qHint{ margin: 0 0 10px; color: var(--muted); font-size: 14px; }

    .option{
      display:flex; gap:12px; align-items:flex-start;
      padding: 18px;
      margin: 14px 0;
      border-radius: 18px;
      border: 1px solid rgba(148,163,184,.28);
      background: #fff;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .option:hover{ transform: translateY(-1px); border-color: rgba(37,99,235,.35); background: #f8fbff; }
    .option:active{ transform: scale(.99); background: rgba(37,99,235,.07); }
    .option.active{ border-color: rgba(37,99,235,.9); background: rgba(37,99,235,.06); }

    .bullet{
      width: 24px; height: 24px;
      border-radius: 10px;
      border: 2px solid rgba(148,163,184,.5);
      margin-top: 2px;
      flex: 0 0 auto;
      position: relative;
    }
    .option.active .bullet{ border-color: rgba(37,99,235,.9); background: rgba(37,99,235,.12); }
    .option.active .bullet:after{
      content:"";
      position:absolute; inset:5px;
      border-radius: 6px;
      background: linear-gradient(135deg, var(--primary), var(--primary2));
    }

    .navRow{ display:flex; gap:10px; margin-top:16px; }
    .navRow .btn{ flex: 2; }
    .navRow .btnGhost{ flex: 1; }

    input[type="text"], input[type="tel"]{
      width:100%;
      padding: 14px 14px;
      border-radius: 18px;
      border: 1px solid rgba(148,163,184,.35);
      background:#fff;
      font-size: 16px;
      outline:none;
      font-family: inherit;
    }
    .formGrid{ display:grid; gap:10px; margin-top: 12px; }

    .summaryBox{
      border-radius: 18px;
      padding: 14px;
      border:1px solid rgba(148,163,184,.25);
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      color: var(--muted);
      font-size: 14px;
    }

    .legal{ margin-top: 14px; color: rgba(15,23,42,.65); font-size: 12.5px; line-height:1.6; }
    footer{ margin-top: 18px; color: rgba(255,255,255,.78); font-size: 12.5px; text-align: center; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="mark">âœ“</div>
        <div>
          <div class="brandTitle">×¡×“×¨ ×–×›×•×™×•×ª</div>
          <div style="font-size:12.5px; color:rgba(255,255,255,.78); font-weight:700">×‘×“×™×§×” ×§×¦×¨×” ××—×¨×™ ×¤×’×™×¢×” ×‘×¢×‘×•×“×”</div>
        </div>
      </div>
      <div class="chips">
        <span class="chip"><span class="dot"></span> ×œ×œ× ×”×ª×—×™×™×‘×•×ª</span>
        <span class="chip">ğŸ”’ ×“×™×¡×§×¨×˜×™</span>
        <span class="chip">â± ×‘×¢×¨×š 2 ×“×§×•×ª</span>
      </div>
    </div>

    <div class="shell">
      <!-- LANDING -->
      <div id="landing" class="grid">
        <div class="card">
          <h1>× ×¤×’×¢×ª ×‘×¢×‘×•×“×”? ×‘×•× × ×¢×©×” ×¡×“×¨ ×¨×’×¢.</h1>
          <p class="lead">
            ×–×• ×‘×“×™×§×” ×§×¦×¨×” ×©××¡×“×¨×ª ×ª××•× ×” ×¨××©×•× ×™×ª ××—×¨×™ ×¤×’×™×¢×” ×©×§×©×•×¨×” ×œ×¢×‘×•×“×”.
            ××™×Ÿ ×›××Ÿ ×™×™×¢×•×¥ ××©×¤×˜×™ ×•××™×Ÿ ×”×ª×—×™×™×‘×•×ª ×œ×ª×•×¦××”.
          </p>

          <div class="ctaRow">
            <button class="btn" id="startBtn" type="button">××ª×—×™×œ×™× ×‘×“×™×§×”</button>
            <button class="btn btnGhost" id="scrollFaqBtn" type="button">×©××œ×•×ª × ×¤×•×¦×•×ª</button>
          </div>

          <div class="features">
            <div class="feat">
              <div class="ico">ğŸ§ </div>
              <div><b>×‘×¨×•×¨ ×•×¤×©×•×˜</b><span>×©××œ×” ××—×ª ×‘×›×œ ××¡×š â€” ×‘×œ×™ ×¡×™×‘×•×›×™×.</span></div>
            </div>
            <div class="feat">
              <div class="ico">ğŸ›¡ï¸</div>
              <div><b>×“×™×¡×§×¨×˜×™</b><span>××ª×” ××—×œ×™×˜ ×× ×œ×”×©××™×¨ ×¤×¨×˜×™× ×‘×¡×•×£.</span></div>
            </div>
            <div class="feat">
              <div class="ico">âš¡</div>
              <div><b>××”×™×¨ ×•× ×•×—</b><span>××ª××™× ×’× ××”×˜×œ×¤×•×Ÿ â€” ×‘×œ×™ ×œ×”×ª×‘×¨×‘×¨.</span></div>
            </div>
          </div>

          <div id="faq" style="margin-top:18px;">
            <div style="font-weight:900; margin-bottom:8px;">×©××œ×•×ª × ×¤×•×¦×•×ª</div>
            <details><summary>×–×” ×™×™×¢×•×¥ ××©×¤×˜×™?</summary><p>×œ×. ×–×• ×‘×“×™×§×” ×¨××©×•× ×™×ª ×‘×œ×‘×“ ×œ×¦×•×¨×š ×¡×“×¨ ×•×”×›×•×•× ×” ×›×œ×œ×™×ª.</p></details>
            <details><summary>××ª× ×‘×™×˜×•×— ×œ××•××™?</summary><p>×œ×. ×–×” ××ª×¨ ×¤×¨×˜×™ ×©××™× ×• ×§×©×•×¨ ×œ×‘×™×˜×•×— ×”×œ××•××™ ××• ×œ×›×œ ×’×•×£ ×××©×œ×ª×™.</p></details>
            <details><summary>×–×” ×¤×•×’×¢ ×‘×™×—×¡×™× ×¢× ×”××¢×¡×™×§?</summary><p>×œ×. ×”×‘×“×™×§×” ×“×™×¡×§×¨×˜×™×ª ×•××™×Ÿ ×¦×•×¨×š ×œ×¢×¨×‘ ××ª ×”××¢×¡×™×§ ×‘×©×œ×‘ ×”×–×”.</p></details>
          </div>

          <div class="legal" style="margin-top: 14px;">
            *×”××ª×¨ ××™× ×• ××ª×¨ ×¨×©××™ ×©×œ ×”×‘×™×˜×•×— ×”×œ××•××™ ×•××™× ×• ××¡×¤×§ ×™×™×¢×•×¥ ××©×¤×˜×™. ××˜×¨×ª×• ×¡×™× ×•×Ÿ ×•××™×“×¢ ×¨××©×•× ×™ ×‘×œ×‘×“.
          </div>
        </div>

        <div class="card">
          <div style="font-weight:900; font-size:18px; margin-bottom:10px;">××™×š ×–×” ×¢×•×‘×“?</div>

          <div class="howWrap">
            <div class="howItem">
              <div class="howNum">1</div>
              <div><b style="font-weight:900">×¢×•× ×” ×¢×œ ×›××” ×©××œ×•×ª ×§×¦×¨×•×ª</b><div style="color:var(--muted)">×˜×¨×™×•×ª, ×—×•××¨×”, ×ª×™×¢×•×“ ×•×¡×˜×˜×•×¡.</div></div>
            </div>

            <div class="howItem">
              <div class="howNum">2</div>
              <div><b style="font-weight:900">××§×‘×œ ×¡×™×›×•× ×¨××©×•× ×™</b><div style="color:var(--muted)">×ª××•× ×” ×›×œ×œ×™×ª (×œ× ×™×™×¢×•×¥).</div></div>
            </div>

            <div class="howItem">
              <div class="howNum">3</div>
              <div><b style="font-weight:900">×‘×¡×•×£ â€” ×× ×ª×¨×¦×”, ×ª×•×›×œ ×œ×”×©××™×¨ ×¤×¨×˜×™×</b><div style="color:var(--muted)">×œ×‘×“×™×§×” ×•×”×¤× ×™×” ×œ×’×•×¨× ××§×¦×•×¢×™ ××ª××™×.</div></div>
            </div>
          </div>

          <div style="margin-top:14px;">
            <button class="btn" type="button" id="startBtn2" style="width:100%;">×™××œ×œ×”, ××ª×—×™×œ×™×</button>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="quiz" class="card hidden">
        <div class="quizHead">
          <div class="progressText" id="progressTxt">×©××œ×” 1 ××ª×•×š 8</div>
          <div class="progressText">â± ×‘×¢×¨×š 2 ×“×§×•×ª</div>
        </div>
        <div class="bar"><div id="progressFill" class="fill"></div></div>

        <h2 id="qTitle" class="qTitle"></h2>
        <p id="qHint" class="qHint"></p>
        <div id="qForm"></div>

        <div class="navRow">
          <button class="btn btnGhost" id="backBtn" type="button">××—×•×¨×”</button>
          <button class="btn" id="nextBtn" type="button">×”××©×š</button>
        </div>
      </div>

      <!-- DONE -->
      <div id="done" class="card hidden">
        <h2 style="margin:0 0 8px; font-weight:900; letter-spacing:-.2px;">×¡×™×›×•× ×§×¦×¨ âœ…</h2>
        <div id="summaryBox" class="summaryBox"></div>

        <div class="formGrid">
          <input type="text" id="fullName" placeholder="×©× ××œ×" autocomplete="name" />
          <input type="tel" id="phone" placeholder="××¡×¤×¨ × ×™×™×“" autocomplete="tel" inputmode="tel" />

          <!-- honeypot anti-bot -->
          <input type="text" id="website" class="hidden" tabindex="-1" autocomplete="off" />

          <label style="display:flex; gap:10px; align-items:flex-start; font-size:13.5px; color:var(--muted);">
            <input type="checkbox" id="consent" style="margin-top:4px;">
            <span>×× ×™ ×××©×¨ ×™×¦×™×¨×ª ×§×©×¨ ×œ×’×‘×™ ×ª×•×¦××•×ª ×”×‘×“×™×§×”, ×•××‘×™×Ÿ ×©××™×Ÿ ×›××Ÿ ×™×™×¢×•×¥ ××©×¤×˜×™.</span>
          </label>

          <button class="btn" id="submitBtn" type="button">×©×œ×™×—×ª ×¤×¨×˜×™×</button>
          <div class="legal">×”×¤×¨×˜×™× × ××¡×¨×™× ×œ×¦×•×¨×š ×‘×“×™×§×” ×•×”×¤× ×™×” ×œ×’×•×¨× ××§×¦×•×¢×™ ××ª××™× ×‘×œ×‘×“.</div>
        </div>

        <div class="legal" style="margin-top: 10px;">
          *××™×Ÿ ×›××Ÿ ×™×™×¢×•×¥ ××©×¤×˜×™ ××• ×”×‘×˜×—×ª ×ª×•×¦××”. ×”××ª×¨ ××™× ×• ×§×©×•×¨ ×œ×‘×™×˜×•×— ×”×œ××•××™ ××• ×œ×’×•×£ ×××©×œ×ª×™.
        </div>
      </div>
    </div>

    <footer style="margin-top: 30px;">×¡×“×¨ ×–×›×•×™×•×ª Â· ×‘×“×™×§×” ×§×¦×¨×” ××—×¨×™ ×¤×’×™×¢×” ×‘×¢×‘×•×“×”</footer>
  </div>

<script>
  const WEBHOOK_URL = "https://hook.eu1.make.com/zodd6hyaiagfivgofyy1h6jjamyymm23";

  document.addEventListener("DOMContentLoaded", () => {
    const els = {
      landing: document.getElementById("landing"),
      quiz: document.getElementById("quiz"),
      done: document.getElementById("done"),
      startBtn: document.getElementById("startBtn"),
      startBtn2: document.getElementById("startBtn2"),
      scrollFaqBtn: document.getElementById("scrollFaqBtn"),
      progressFill: document.getElementById("progressFill"),
      progressTxt: document.getElementById("progressTxt"),
      qTitle: document.getElementById("qTitle"),
      qHint: document.getElementById("qHint"),
      qForm: document.getElementById("qForm"),
      backBtn: document.getElementById("backBtn"),
      nextBtn: document.getElementById("nextBtn"),
      summaryBox: document.getElementById("summaryBox"),
      fullName: document.getElementById("fullName"),
      phone: document.getElementById("phone"),
      submitBtn: document.getElementById("submitBtn"),
      consent: document.getElementById("consent"),
      website: document.getElementById("website"),
    };

    const startedAt = Date.now();

    const state = {
      step: 0,
      killed: false,
      killReason: null,
      scoreRaw: 0,
      scoreNorm: 0,
      tier: null,
      reasons: [],
      flags: [],
      answers: {
        status:null, event:null, when:null, care:null, body:null, absent:null, docs:null, represented:null
      }
    };

    const steps = [
      {
        key:"status",
        title:"××” ×”×¡×˜×˜×•×¡ ×©×œ×š ×›×¨×’×¢?",
        hint:"×›×“×™ ×œ×•×•×“× ×©×”×‘×“×™×§×” ××ª××™××”.",
        options:[
          {l:"×©×›×™×¨", v:"employee", pts:0},
          {l:"×¢×¦×××™", v:"self", pts:0},
          {l:"×¤× ×¡×™×•× ×¨ / ×œ× ×¢×•×‘×“", v:"not_working", kill:true, killReason:"×”×‘×“×™×§×” ××™×•×¢×“×ª ×›×¨×’×¢ ×œ××™ ×©× ×¤×’×¢ ×‘××”×œ×š ×¢×‘×•×“×ª×•."},
          {l:"×—×™×™×œ / ×›×•×—×•×ª ×”×‘×™×˜×—×•×Ÿ", v:"security", kill:true, killReason:"×‘××§×¨×” ×”×–×” ×œ×¨×•×‘ ×¤×•× ×™× ×œ×§×¦×™×Ÿ ×ª×’××•×œ×™×/××©×¨×“ ×”×‘×™×˜×—×•×Ÿ."}
        ]
      },
      {
        key:"event",
        title:"××™×–×” ×¡×•×’ ××™×¨×•×¢ ×¢×‘×¨×ª?",
        hint:"×–×” ×¢×•×–×¨ ×œ×–×”×•×ª ××¡×œ×•×œ ×‘×“×™×§×” × ×›×•×Ÿ.",
        options:[
          {l:"×ª××•× ×” ×¤×ª××•××™×ª ×‘×¢×‘×•×“×” (× ×¤×™×œ×”/××›×”/×”×¨××”)", v:"sudden", pts:10},
          {l:"×ª××•× ×ª ×“×¨×›×™× ×‘×“×¨×š ×œ×¢×‘×•×“×”/××× ×”/×‘××”×œ×š ×”×¢×‘×•×“×”", v:"rta_work", pts:25},
          {l:"×›××‘×™× ×©×”×ª×¤×ª×—×• ×œ××•×¨×š ×–××Ÿ ×‘×’×œ×œ ×”×¢×‘×•×“×”", v:"gradual", pts:5},
          {l:"×¤×’×™×¢×” ×‘×‘×™×ª/×‘×—×•×¤×©×” ×¤×¨×˜×™×ª", v:"private", kill:true, killReason:"×”×‘×“×™×§×” ×”×–×• ××™×•×¢×“×ª ×œ×¤×’×™×¢×” ×©×§×©×•×¨×” ×œ×¢×‘×•×“×”."}
        ]
      },
      {
        key:"when",
        title:"××ª×™ ×§×¨×” ×”××§×¨×” (××• ××ª×™ ×”×ª×—×™×œ×• ×”×›××‘×™×)?",
        hint:"×›×›×œ ×©×–×” ×˜×¨×™ ×™×•×ª×¨ â€” ×§×œ ×™×•×ª×¨ ×œ×ª×¢×“.",
        options:[
          {l:"×‘×—×•×“×© ×”××—×¨×•×Ÿ", v:"1m", pts:40},
          {l:"×‘-3 ×”×—×•×“×©×™× ×”××—×¨×•× ×™×", v:"3m", pts:30},
          {l:"×‘×©× ×” ×”××—×¨×•× ×”", v:"1y", pts:15},
          {l:"×‘×™×Ÿ ×©× ×” ×œ-3 ×©× ×™×", v:"1to3y", pts:0},
          {l:"×œ×¤× ×™ ×™×•×ª×¨ ×-3 ×©× ×™×", v:"3yplus", pts:-50, flag:"××§×¨×” ×™×©×Ÿ ×××•×“ (×§×•×©×™ ×¨××™×™×ª×™)"}
        ]
      },
      {
        key:"care",
        title:"×”×× ×§×™×‘×œ×ª ×˜×™×¤×•×œ ×¨×¤×•××™ ×‘×¢×§×‘×•×ª ×”×¤×’×™×¢×”?",
        hint:"×–×” × ×•×ª×Ÿ ××™× ×“×™×§×¦×™×” ×œ×—×•××¨×” ×•×œ×ª×™×¢×•×“.",
        options:[
          {l:"×›×Ÿ, ×¤×•× ×™×ª×™ ×œ××™×•×Ÿ ××• ××•×©×¤×–×ª×™", v:"er_hosp", pts:30},
          {l:"×›×Ÿ, ×©×‘×¨×™×/×§×¨×¢×™×/×¦×•×¨×š ×‘× ×™×ª×•×—", v:"fracture_surgery", pts:30},
          {l:"×¨×•×¤× ××©×¤×—×” / ××•×§×“", v:"gp", pts:10},
          {l:"×¢×•×“ ×œ× ×”×œ×›×ª×™ ×œ×¨×•×¤×", v:"no_care", pts:-20, flag:"××™×Ÿ ×˜×™×¤×•×œ ×¨×¤×•××™ ×¢×“×™×™×Ÿ"}
        ]
      },
      {
        key:"body",
        title:"××™×¤×” ×‘×’×•×£ × ×¤×’×¢×ª ×‘×¢×™×§×¨?",
        hint:"×¨×§ ×›×“×™ ×œ×”×‘×™×Ÿ ×›×™×•×•×Ÿ ×›×œ×œ×™.",
        options:[
          {l:"×’×‘/×¦×•×•××¨/×¢××•×“ ×©×“×¨×”", v:"spine", pts:15},
          {l:"×¨××© / ×¨×‘-××¢×¨×›×ª×™", v:"head_multi", pts:20},
          {l:"×’×¤×™×™× (×™×“/×¨×’×œ/×‘×¨×š/×›×ª×£)", v:"limbs", pts:10},
          {l:"××›×•×ª ×™×‘×©×•×ª/×©×¨×™×˜×•×ª ×‘×œ×‘×“", v:"minor_hits", pts:-10}
        ]
      },
      {
        key:"absent",
        title:"×”×× × ×¢×“×¨×ª ××”×¢×‘×•×“×” ×‘×¢×§×‘×•×ª ×”×¤×’×™×¢×”?",
        hint:"×–×” ××¡××Ÿ ×¤×’×™×¢×” ×ª×¤×§×•×“×™×ª.",
        options:[
          {l:"×›×Ÿ, ××¢×œ 14 ×™×•×", v:"gt14", pts:15},
          {l:"×›×Ÿ, ×›××” ×™××™× ×‘×•×“×“×™×", v:"few", pts:5},
          {l:"×œ×, ×”××©×›×ª×™ ×œ×¢×‘×•×“ ×›×¨×’×™×œ", v:"none", pts:-10}
        ]
      },
      {
        key:"docs",
        title:"×”×× ×™×© ×œ×š ××¡××›×™× ×¨×¤×•××™×™× ×¨××©×•× ×™×™×?",
        hint:"××¡××š ××—×“ ×›×‘×¨ ×¢×•×©×” ×”×‘×“×œ.",
        options:[
          {l:"×›×Ÿ, ×¡×™×›×•×/××™×©×•×¨ ××—×œ×”/××¡××š ×¨×¤×•××™", v:"yes", pts:15},
          {l:"×¢×“×™×™×Ÿ ×œ×, ××‘×œ ××©×™×’", v:"will_get", pts:0},
          {l:"×œ×", v:"no", pts:-5}
        ]
      },
      {
        key:"represented",
        title:"×”×× ×›×‘×¨ ×¤× ×™×ª ×œ×¢×•×¨×š ×“×™×Ÿ ××• ×©××ª×” ××™×•×¦×’?",
        hint:"×›×“×™ ×œ× ×œ×‘×–×‘×– ×–××Ÿ.",
        options:[
          {l:"×œ×, ×˜×¨× ×˜×™×¤×œ×ª×™ ×‘×–×”", v:"no", pts:20},
          {l:"× ×™×¡×™×ª×™ ×œ×‘×“/× ×“×—×™×ª×™/×§×™×‘×œ×ª×™ ×¡×›×•× × ××•×š", v:"tried", pts:5},
          {l:"×× ×™ ×›×‘×¨ ××™×•×¦×’ ×¢×œ ×™×“×™ ×¢×•\"×“", v:"yes", kill:true, killReason:"×× ×›×‘×¨ ×™×© ×™×™×¦×•×’, ×‘×“×¨×š ×›×œ×œ ×œ× × ×•×›×œ ×œ×¢×–×•×¨ ×‘×”××©×š."}
        ]
      },
    ];

    function applyKillIfNeeded() {
      const s = steps[state.step];
      const v = state.answers[s.key];
      const opt = s.options.find(o => o.v === v);
      if (opt && opt.kill) {
        state.killed = true;
        state.killReason = opt.killReason || "×”××§×¨×” ×œ× ××ª××™× ×œ×‘×“×™×§×”.";
      }
    }

    function calcScoreAndMeta() {
      let score = 0;
      const reasons = [];
      const flags = [];

      for (const s of steps) {
        const v = state.answers[s.key];
        const opt = s.options.find(o => o.v === v);
        if (!opt) continue;

        score += (opt.pts || 0);
        if (opt.flag) flags.push(opt.flag);

        if (s.key === "event" && v === "rta_work") reasons.push("×ª××•× ×ª ×“×¨×›×™× ×§×©×•×¨×” ×œ×¢×‘×•×“×”");
        if (s.key === "when" && (v === "1m" || v === "3m")) reasons.push("××§×¨×” ×˜×¨×™ ×™×—×¡×™×ª");
        if (s.key === "care" && (v === "er_hosp" || v === "fracture_surgery")) reasons.push("×˜×™×¤×•×œ ××©××¢×•×ª×™/×¤×’×™×¢×” ×§×©×”");
        if (s.key === "docs" && v === "yes") reasons.push("×™×© ×ª×™×¢×•×“ ×¨×¤×•××™");
        if (s.key === "represented" && v === "no") reasons.push("×œ× ××™×•×¦×’ (×œ×™×“ ×‘×ª×•×œ×™)");
      }

      const norm = Math.max(0, Math.min(100, Math.round((score / 165) * 100)));

      let tier = "Bronze";
      if (norm >= 85) tier = "Platinum";
      else if (norm >= 50) tier = "Gold";
      else if (norm >= 20) tier = "Silver";

      if ((state.answers.care === "er_hosp" || state.answers.care === "fracture_surgery") && state.answers.absent === "none") {
        flags.push("×¡×ª×™×¨×” ××¤×©×¨×™×ª: ×˜×™×¤×•×œ ××©××¢×•×ª×™ ××š ×œ×œ× ×”×™×¢×“×¨×•×ª");
      }

      const seconds = Math.round((Date.now() - startedAt) / 1000);
      if (seconds < 40) flags.push("××™×œ×•×™ ××”×™×¨ ×××•×“ (×™×ª×›×Ÿ ×‘×•×˜/×—×•×¡×¨ ×¨×¦×™× ×•×ª)");

      state.scoreRaw = score;
      state.scoreNorm = norm;
      state.tier = tier;
      state.reasons = Array.from(new Set(reasons)).slice(0, 4);
      state.flags = Array.from(new Set(flags)).slice(0, 6);
    }

    function saleStatusFromTier(tier) {
      return (tier === "Platinum" || tier === "Gold" || tier === "Silver") ? "sell" : "no_sell";
    }

    function buildSummary() {
      calcScoreAndMeta();

      const bullets = (state.reasons.length ? state.reasons : ["×™×© × ×ª×•× ×™× ×¨××©×•× ×™×™× ×œ×‘×“×™×§×”"])
        .map(t => `â€¢ ${t}`).join("<br>");

      const warn = state.flags.length
        ? `<div style="margin-top:10px; color:#b45309; font-weight:800;">×œ×ª×©×•××ª ×œ×‘: ${state.flags.join(" Â· ")}</div>`
        : "";

      return `
        <div style="font-weight:900; color:var(--text); margin-bottom:6px;">××” ×”×ª×§×‘×œ ××”×‘×“×™×§×”:</div>
        <div>${bullets}</div>
        <div style="margin-top:10px;">×× ×ª×¨×¦×” â€” ×”×©××¨ ×¤×¨×˜×™× ×œ×¦×•×¨×š ×‘×“×™×§×” ×•×”×¤× ×™×” ×œ×’×•×¨× ××§×¦×•×¢×™ ××ª××™×.</div>
        ${warn}
      `;
    }

    function goQuiz(){
      els.landing.classList.add("hidden");
      els.quiz.classList.remove("hidden");
      els.done.classList.add("hidden");
      render();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function render(){
      const s = steps[state.step];
      els.qTitle.textContent = s.title;
      els.qHint.textContent = s.hint || "";
      els.progressTxt.textContent = `×©××œ×” ${state.step+1} ××ª×•×š ${steps.length}`;
      els.progressFill.style.width = ((state.step+1)/steps.length)*100 + "%";

      els.qForm.innerHTML = "";
      s.options.forEach(opt=>{
        const div = document.createElement("div");
        div.className = "option" + (state.answers[s.key] === opt.v ? " active" : "");
        div.innerHTML = `<div class="bullet" aria-hidden="true"></div><div style="font-weight:900; font-size:16px; line-height:1.25">${opt.l}</div>`;
        div.onclick = ()=>{
          state.answers[s.key]=opt.v;
          applyKillIfNeeded();
          render();
        };
        els.qForm.appendChild(div);
      });

      els.nextBtn.disabled = !state.answers[s.key];
      els.backBtn.disabled = state.step === 0;
    }

    async function postLead(payload) {
      try {
        await fetch(WEBHOOK_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
        return true;
      } catch (e) {
        console.error("Webhook error:", e);
        return true;
      }
    }

    function getUTM() {
      const params = new URLSearchParams(location.search);
      const obj = {};
      for (const [k,v] of params.entries()) obj[k] = v;
      return obj;
    }

    els.startBtn.onclick = goQuiz;
    els.startBtn2.onclick = goQuiz;

    els.scrollFaqBtn.onclick = ()=>{
      document.getElementById("faq").scrollIntoView({ behavior:"smooth", block:"start" });
    };

    els.backBtn.onclick = ()=>{ if(state.step>0){ state.step--; render(); } };

    els.nextBtn.onclick = ()=>{
      if (state.killed) {
        els.quiz.classList.add("hidden");
        els.done.classList.remove("hidden");
        els.summaryBox.innerHTML = `
          <div style="font-weight:900; margin-bottom:6px;">×¨×’×¢ ×§×˜×Ÿ ğŸ™</div>
          <div style="color:var(--muted)">${state.killReason}</div>
          <div style="margin-top:10px; color:var(--muted)">×× ×ª×¨×¦×”, ×ª×•×›×œ ×¢×“×™×™×Ÿ ×œ×”×©××™×¨ ×¤×¨×˜×™× ×œ×¦×•×¨×š ×‘×“×™×§×” ×•×”×¤× ×™×”.</div>
        `;
        window.scrollTo({top:0, behavior:"smooth"});
        return;
      }

      if(state.step < steps.length-1){
        state.step++;
        render();
        window.scrollTo({top:0, behavior:"smooth"});
      } else {
        els.quiz.classList.add("hidden");
        els.done.classList.remove("hidden");
        els.summaryBox.innerHTML = buildSummary();
        window.scrollTo({top:0, behavior:"smooth"});
      }
    };

    els.submitBtn.onclick = async ()=>{
      const name = (els.fullName.value||"").trim();
      const phone = (els.phone.value||"").trim();

      const hp = (els.website.value||"").trim();
      if (hp) return;

      if (!els.consent.checked) return alert("×‘×‘×§×©×” ×¡××Ÿ ××™×©×•×¨ ×™×¦×™×¨×ª ×§×©×¨");
      if(!name) return alert("×‘×‘×§×©×” ×›×ª×•×‘ ×©× ××œ×");

      const digits = phone.replace(/\D/g,"");
      const isILMobile = (digits.length === 10 && digits.startsWith("05")) || (digits.length === 9 && digits.startsWith("5"));
      if(!isILMobile) return alert("×‘×‘×§×©×” ×›×ª×•×‘ ××¡×¤×¨ × ×™×™×“ ×™×©×¨××œ×™ ×ª×§×™×Ÿ");

      const ttc = Math.round((Date.now() - startedAt) / 1000);
      if (ttc < 15) return alert("×‘×‘×§×©×” × ×¡×” ×©×•×‘ ×‘×¢×•×“ ×¨×’×¢");

      calcScoreAndMeta();

      const payload = {
        name,
        phone: digits,
        answers: state.answers,

        score_raw: state.scoreRaw,
        score_norm: state.scoreNorm,
        tier: state.tier,
        sale_status: saleStatusFromTier(state.tier),

        reasons: state.reasons,
        flags: state.flags,

        time_to_complete_sec: ttc,
        utm: getUTM(),

        source: "seder_zchuyot",
        page: location.href,
        ts: new Date().toISOString()
      };

      const oldText = els.submitBtn.textContent;
      els.submitBtn.disabled = true;
      els.submitBtn.textContent = "×©×•×œ×—â€¦";

      const ok = await postLead(payload);

      if(ok){
        window.location.href = "thankyou.html";
      } else {
        alert("××©×”×• ×œ× ×¢×‘×¨. × ×¡×” ×©×•×‘ ×‘×¢×•×“ ×“×§×”.");
        els.submitBtn.disabled = false;
        els.submitBtn.textContent = oldText;
      }
    };
  });
</script>
</body>
</html>
 
